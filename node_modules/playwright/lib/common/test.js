"use strict";
<<<<<<< HEAD
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var test_exports = {};
__export(test_exports, {
  Suite: () => Suite,
  TestCase: () => TestCase
});
module.exports = __toCommonJS(test_exports);
var import_testType = require("./testType");
var import_teleReceiver = require("../isomorphic/teleReceiver");
class Base {
  constructor(title) {
    this._only = false;
    this._requireFile = "";
=======

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TestCase = exports.Suite = void 0;
var _testType = require("./testType");
var _teleReceiver = require("../isomorphic/teleReceiver");
/**
 * Copyright Microsoft Corporation. All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class Base {
  constructor(title) {
    this.title = void 0;
    this._only = false;
    this._requireFile = '';
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    this.title = title;
  }
}
class Suite extends Base {
  constructor(title, type) {
    super(title);
<<<<<<< HEAD
    this._use = [];
    this._entries = [];
    this._hooks = [];
=======
    this.location = void 0;
    this.parent = void 0;
    this._use = [];
    this._entries = [];
    this._hooks = [];
    this._timeout = void 0;
    this._retries = void 0;
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    // Annotations known statically before running the test, e.g. `test.describe.skip()` or `test.describe({ annotation }, body)`.
    this._staticAnnotations = [];
    // Explicitly declared tags that are not a part of the title.
    this._tags = [];
    this._modifiers = [];
<<<<<<< HEAD
    this._parallelMode = "none";
=======
    this._parallelMode = 'none';
    this._fullProject = void 0;
    this._fileId = void 0;
    this._type = void 0;
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    this._type = type;
  }
  get type() {
    return this._type;
  }
  entries() {
    return this._entries;
  }
  get suites() {
<<<<<<< HEAD
    return this._entries.filter((entry) => entry instanceof Suite);
  }
  get tests() {
    return this._entries.filter((entry) => entry instanceof TestCase);
=======
    return this._entries.filter(entry => entry instanceof Suite);
  }
  get tests() {
    return this._entries.filter(entry => entry instanceof TestCase);
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
  }
  _addTest(test) {
    test.parent = this;
    this._entries.push(test);
  }
  _addSuite(suite) {
    suite.parent = this;
    this._entries.push(suite);
  }
  _prependSuite(suite) {
    suite.parent = this;
    this._entries.unshift(suite);
  }
  allTests() {
    const result = [];
<<<<<<< HEAD
    const visit = (suite) => {
      for (const entry of suite._entries) {
        if (entry instanceof Suite)
          visit(entry);
        else
          result.push(entry);
=======
    const visit = suite => {
      for (const entry of suite._entries) {
        if (entry instanceof Suite) visit(entry);else result.push(entry);
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      }
    };
    visit(this);
    return result;
  }
  _hasTests() {
    let result = false;
<<<<<<< HEAD
    const visit = (suite) => {
      for (const entry of suite._entries) {
        if (result)
          return;
        if (entry instanceof Suite)
          visit(entry);
        else
          result = true;
=======
    const visit = suite => {
      for (const entry of suite._entries) {
        if (result) return;
        if (entry instanceof Suite) visit(entry);else result = true;
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      }
    };
    visit(this);
    return result;
  }
  titlePath() {
    const titlePath = this.parent ? this.parent.titlePath() : [];
<<<<<<< HEAD
    if (this.title || this._type !== "describe")
      titlePath.push(this.title);
    return titlePath;
  }
  _collectGrepTitlePath(path) {
    if (this.parent)
      this.parent._collectGrepTitlePath(path);
    if (this.title || this._type !== "describe")
      path.push(this.title);
=======
    // Ignore anonymous describe blocks.
    if (this.title || this._type !== 'describe') titlePath.push(this.title);
    return titlePath;
  }
  _collectGrepTitlePath(path) {
    if (this.parent) this.parent._collectGrepTitlePath(path);
    if (this.title || this._type !== 'describe') path.push(this.title);
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    path.push(...this._tags);
  }
  _getOnlyItems() {
    const items = [];
<<<<<<< HEAD
    if (this._only)
      items.push(this);
    for (const suite of this.suites)
      items.push(...suite._getOnlyItems());
    items.push(...this.tests.filter((test) => test._only));
=======
    if (this._only) items.push(this);
    for (const suite of this.suites) items.push(...suite._getOnlyItems());
    items.push(...this.tests.filter(test => test._only));
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    return items;
  }
  _deepClone() {
    const suite = this._clone();
    for (const entry of this._entries) {
<<<<<<< HEAD
      if (entry instanceof Suite)
        suite._addSuite(entry._deepClone());
      else
        suite._addTest(entry._clone());
=======
      if (entry instanceof Suite) suite._addSuite(entry._deepClone());else suite._addTest(entry._clone());
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    }
    return suite;
  }
  _deepSerialize() {
    const suite = this._serialize();
    suite.entries = [];
    for (const entry of this._entries) {
<<<<<<< HEAD
      if (entry instanceof Suite)
        suite.entries.push(entry._deepSerialize());
      else
        suite.entries.push(entry._serialize());
=======
      if (entry instanceof Suite) suite.entries.push(entry._deepSerialize());else suite.entries.push(entry._serialize());
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    }
    return suite;
  }
  static _deepParse(data) {
    const suite = Suite._parse(data);
    for (const entry of data.entries) {
<<<<<<< HEAD
      if (entry.kind === "suite")
        suite._addSuite(Suite._deepParse(entry));
      else
        suite._addTest(TestCase._parse(entry));
=======
      if (entry.kind === 'suite') suite._addSuite(Suite._deepParse(entry));else suite._addTest(TestCase._parse(entry));
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    }
    return suite;
  }
  forEachTest(visitor) {
    for (const entry of this._entries) {
<<<<<<< HEAD
      if (entry instanceof Suite)
        entry.forEachTest(visitor);
      else
        visitor(entry, this);
=======
      if (entry instanceof Suite) entry.forEachTest(visitor);else visitor(entry, this);
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    }
  }
  _serialize() {
    return {
<<<<<<< HEAD
      kind: "suite",
=======
      kind: 'suite',
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      title: this.title,
      type: this._type,
      location: this.location,
      only: this._only,
      requireFile: this._requireFile,
      timeout: this._timeout,
      retries: this._retries,
      staticAnnotations: this._staticAnnotations.slice(),
      tags: this._tags.slice(),
      modifiers: this._modifiers.slice(),
      parallelMode: this._parallelMode,
<<<<<<< HEAD
      hooks: this._hooks.map((h) => ({ type: h.type, location: h.location, title: h.title })),
=======
      hooks: this._hooks.map(h => ({
        type: h.type,
        location: h.location,
        title: h.title
      })),
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      fileId: this._fileId
    };
  }
  static _parse(data) {
    const suite = new Suite(data.title, data.type);
    suite.location = data.location;
    suite._only = data.only;
    suite._requireFile = data.requireFile;
    suite._timeout = data.timeout;
    suite._retries = data.retries;
    suite._staticAnnotations = data.staticAnnotations;
    suite._tags = data.tags;
    suite._modifiers = data.modifiers;
    suite._parallelMode = data.parallelMode;
<<<<<<< HEAD
    suite._hooks = data.hooks.map((h) => ({ type: h.type, location: h.location, title: h.title, fn: () => {
    } }));
=======
    suite._hooks = data.hooks.map(h => ({
      type: h.type,
      location: h.location,
      title: h.title,
      fn: () => {}
    }));
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    suite._fileId = data.fileId;
    return suite;
  }
  _clone() {
    const data = this._serialize();
    const suite = Suite._parse(data);
    suite._use = this._use.slice();
    suite._hooks = this._hooks.slice();
    suite._fullProject = this._fullProject;
    return suite;
  }
  project() {
<<<<<<< HEAD
    return this._fullProject?.project || this.parent?.project();
  }
}
class TestCase extends Base {
  constructor(title, fn, testType, location) {
    super(title);
    this.results = [];
    this.type = "test";
    this.expectedStatus = "passed";
=======
    var _this$_fullProject, _this$parent;
    return ((_this$_fullProject = this._fullProject) === null || _this$_fullProject === void 0 ? void 0 : _this$_fullProject.project) || ((_this$parent = this.parent) === null || _this$parent === void 0 ? void 0 : _this$parent.project());
  }
}
exports.Suite = Suite;
class TestCase extends Base {
  constructor(title, fn, testType, location) {
    super(title);
    this.fn = void 0;
    this.results = [];
    this.location = void 0;
    this.parent = void 0;
    this.type = 'test';
    this.expectedStatus = 'passed';
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    this.timeout = 0;
    this.annotations = [];
    this.retries = 0;
    this.repeatEachIndex = 0;
<<<<<<< HEAD
    this.id = "";
    this._poolDigest = "";
    this._workerHash = "";
    this._projectId = "";
=======
    this._testType = void 0;
    this.id = '';
    this._pool = void 0;
    this._poolDigest = '';
    this._workerHash = '';
    this._projectId = '';
    // Annotations known statically before running the test, e.g. `test.skip()` or `test(title, { annotation }, body)`.
    this._staticAnnotations = [];
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    // Explicitly declared tags that are not a part of the title.
    this._tags = [];
    this.fn = fn;
    this._testType = testType;
    this.location = location;
  }
  titlePath() {
    const titlePath = this.parent ? this.parent.titlePath() : [];
    titlePath.push(this.title);
    return titlePath;
  }
  outcome() {
<<<<<<< HEAD
    return (0, import_teleReceiver.computeTestCaseOutcome)(this);
  }
  ok() {
    const status = this.outcome();
    return status === "expected" || status === "flaky" || status === "skipped";
=======
    return (0, _teleReceiver.computeTestCaseOutcome)(this);
  }
  ok() {
    const status = this.outcome();
    return status === 'expected' || status === 'flaky' || status === 'skipped';
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
  }
  get tags() {
    return this._grepTitle().match(/@[\S]+/g) || [];
  }
  _serialize() {
    return {
<<<<<<< HEAD
      kind: "test",
=======
      kind: 'test',
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      id: this.id,
      title: this.title,
      retries: this.retries,
      timeout: this.timeout,
      expectedStatus: this.expectedStatus,
      location: this.location,
      only: this._only,
      requireFile: this._requireFile,
      poolDigest: this._poolDigest,
      workerHash: this._workerHash,
<<<<<<< HEAD
=======
      staticAnnotations: this._staticAnnotations.slice(),
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
      annotations: this.annotations.slice(),
      tags: this._tags.slice(),
      projectId: this._projectId
    };
  }
  static _parse(data) {
<<<<<<< HEAD
    const test = new TestCase(data.title, () => {
    }, import_testType.rootTestType, data.location);
=======
    const test = new TestCase(data.title, () => {}, _testType.rootTestType, data.location);
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    test.id = data.id;
    test.retries = data.retries;
    test.timeout = data.timeout;
    test.expectedStatus = data.expectedStatus;
    test._only = data.only;
    test._requireFile = data.requireFile;
    test._poolDigest = data.poolDigest;
    test._workerHash = data.workerHash;
<<<<<<< HEAD
=======
    test._staticAnnotations = data.staticAnnotations;
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    test.annotations = data.annotations;
    test._tags = data.tags;
    test._projectId = data.projectId;
    return test;
  }
  _clone() {
    const data = this._serialize();
    const test = TestCase._parse(data);
    test._testType = this._testType;
    test.fn = this.fn;
    return test;
  }
  _appendTestResult() {
    const result = {
      retry: this.results.length,
      parallelIndex: -1,
      workerIndex: -1,
      duration: 0,
<<<<<<< HEAD
      startTime: /* @__PURE__ */ new Date(),
      stdout: [],
      stderr: [],
      attachments: [],
      status: "skipped",
      steps: [],
      errors: [],
      annotations: []
=======
      startTime: new Date(),
      stdout: [],
      stderr: [],
      attachments: [],
      status: 'skipped',
      steps: [],
      errors: []
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
    };
    this.results.push(result);
    return result;
  }
  _grepTitle() {
    const path = [];
    this.parent._collectGrepTitlePath(path);
    path.push(this.title);
    path.push(...this._tags);
<<<<<<< HEAD
    return path.join(" ");
  }
}
// Annotate the CommonJS export names for ESM import in node:
0 && (module.exports = {
  Suite,
  TestCase
});
=======
    return path.join(' ');
  }
}
exports.TestCase = TestCase;
>>>>>>> 0bbb606fffa4286e884fc3bf9391c67f4bdb0fbb
